# v2.3 Plan ‚Äî BANKR Deep Integration

**Status:** In Progress (tests ‚úÖ, Otaku integration ‚úÖ)
**Created:** 2026-02-12
**Branch:** `feature/v2.3-bankr-integration`

---

## Current State

### plugin-bankr (Agent API)

- **10 actions:** prompt, user info, job status/cancel, sign, submit, order quote/list/status/cancel
- **2 services:** BankrAgentService, BankrOrdersService
- **Capabilities:** Natural language ‚Üí trading jobs, limit/stop/DCA/TWAP orders, signing, tx submission
- ‚úÖ **92 tests** (5 test files)

### plugin-bankr-sdk

- **1 action:** prompt with own wallet
- **1 service:** BankrSdkService
- ‚è≥ Tests pending

### plugin-otaku (NEW)

- **4 actions:** OTAKU_SWAP, OTAKU_LIMIT_ORDER, OTAKU_DCA, OTAKU_POSITIONS
- **1 service:** OtakuService (wraps BANKR with confirmation flows)
- ‚úÖ **45 tests** (2 test files)

---

## Why BANKR Matters for VINCE

From `knowledge/sentinel-docs/BANKR.md`:

> "Token pays the agent: compute, execution, subscriptions. Wallet + swap/limit/perps in the product."

BANKR provides:

1. **Execution layer** ‚Äî swap, bridge, limit, stop, DCA, TWAP, perps
2. **Wallet management** ‚Äî cross-chain (Base, Solana, Polygon, Ethereum)
3. **Natural language trading** ‚Äî "swap 1 ETH for USDC" just works
4. **Token economics** ‚Äî $BNKR funds the agent

---

## v2.3 Proposals

### 1. üß™ Tests for BANKR Plugins (Priority: HIGH)

Both plugins have zero tests. Need:

```
plugin-bankr/src/__tests__/
‚îú‚îÄ‚îÄ bankr-agent.service.test.ts    # Mock API, test prompt/job/sign
‚îú‚îÄ‚îÄ bankr-orders.service.test.ts   # Mock API, test quote/list/cancel
‚îú‚îÄ‚îÄ actions.test.ts                # Action validation
‚îî‚îÄ‚îÄ types.test.ts                  # Type validation
```

**Estimated:** 4-6 test files, ~800 lines

---

### 2. üêô Otaku + BANKR Deep Integration (Priority: HIGH)

Otaku is "the only agent with a funded wallet" ‚Äî should use BANKR for everything.

**Current:** Otaku has DeFi capabilities but execution is fragmented
**Proposed:** BANKR becomes Otaku's execution layer

```typescript
// Example: Otaku uses BANKR for all swaps
"Otaku, swap 0.5 ETH for USDC on Base"
‚Üí BANKR_AGENT_PROMPT action
‚Üí Job polling
‚Üí Transaction signed and submitted
‚Üí Confirmation to user
```

**New Otaku actions:**
| Action | Description |
|--------|-------------|
| `OTAKU_SWAP` | Swap via BANKR (wraps BANKR_AGENT_PROMPT) |
| `OTAKU_LIMIT_ORDER` | Set limit order via BANKR |
| `OTAKU_DCA` | Set up DCA via BANKR |
| `OTAKU_POSITIONS` | Show BANKR positions |

---

### 3. üìä Dashboard Integration (Priority: MEDIUM)

Add BANKR to the leaderboard/dashboard:

**New routes:**

- `/vince/bankr/positions` ‚Äî Active positions
- `/vince/bankr/orders` ‚Äî Open orders
- `/vince/bankr/jobs` ‚Äî Recent job history

**Leaderboard tab:** "Bankr" section showing:

- Open orders (limit, stop, DCA, TWAP)
- Recent trades
- Position summary

---

### 4. üì° Provider for VINCE (Priority: MEDIUM)

VINCE should know about BANKR orders as part of "objective data."

**New provider:** `bankrOrdersProvider`

- Fetches open orders on request
- Provides to VINCE ALOHA as context
- "You have 2 open limit orders on BTC"

---

### 5. ‚öñÔ∏è Solus + BANKR (Priority: LOW)

Solus does execution planning (size/skip/watch). BANKR could be the execution layer.

**Flow:**

```
User ‚Üí "I want to long BTC"
‚Üí VINCE gives data context
‚Üí Solus gives size/skip/watch + invalidation
‚Üí Otaku executes via BANKR with stop loss
```

This requires cross-agent coordination (ASK_AGENT) working well.

---

### 6. üîå OpenClaw Skill (Priority: LOW)

Publish VINCE as a skill in [openclaw-skills](https://github.com/BankrBot/openclaw-skills).

Others can install VINCE's capabilities:

- ALOHA action
- Paper bot
- Options analysis

This is more about ecosystem contribution than core functionality.

---

## Recommended v2.3 Scope

**Done:**

1. ‚úÖ Tests for plugin-bankr (5 test files, 92 tests)
2. ‚úÖ Otaku + BANKR integration (plugin-otaku: 4 actions, 45 tests)
3. ‚úÖ VINCE provider for orders (bankrOrdersProvider)
4. ‚úÖ Tests for plugin-bankr-sdk (2 test files, 27 tests)
5. ‚úÖ Dashboard BANKR tab (dashboardBankr.ts, 9 tests)

**Future (v2.4+):** 6. Solus + BANKR execution flow 7. OpenClaw skill publication

---

## Completed Work

### plugin-bankr Tests (Already existed!)

| File                           | Tests  |
| ------------------------------ | ------ |
| `types.test.ts`                | 19     |
| `bankr-agent.service.test.ts`  | 21     |
| `bankr-orders.service.test.ts` | 15     |
| `bankr.provider.test.ts`       | 8      |
| `actions.test.ts`              | 29     |
| **Total**                      | **92** |

### plugin-otaku (NEW)

| File                    | Tests  |
| ----------------------- | ------ |
| `otaku.service.test.ts` | 13     |
| `actions.test.ts`       | 32     |
| **Total**               | **45** |

### plugin-bankr-sdk (NEW)

| File                        | Tests  |
| --------------------------- | ------ |
| `bankr-sdk.service.test.ts` | 11     |
| `actions.test.ts`           | 16     |
| **Total**                   | **27** |

### plugin-vince

| File                      | Tests | Description                                |
| ------------------------- | ----- | ------------------------------------------ |
| `bankrOrders.provider.ts` | ‚Äî     | Cross-agent: BANKR orders in VINCE context |
| `dashboardBankr.ts`       | 9     | Dashboard route for BANKR tab              |

**Combined: 173 tests for BANKR ecosystem**

---

## Completed

All planned v2.3 tasks are complete:

| Item                   | Files  | Tests   | Lines      |
| ---------------------- | ------ | ------- | ---------- |
| plugin-bankr tests     | 5      | 92      | ~2,500     |
| plugin-otaku           | 15     | 45      | ~1,900     |
| plugin-bankr-sdk tests | 2      | 27      | ~700       |
| VINCE provider         | 1      | ‚Äî       | ~200       |
| Dashboard BANKR tab    | 2      | 9       | ~600       |
| **Total**              | **25** | **173** | **~5,900** |

---

## Decisions Made

1. **Otaku = BANKR executor** ‚Äî No need for 9th agent. Otaku already owns "funded wallet" lane.
2. **All features** ‚Äî DCA, TWAP, Perps all supported via BANKR_AGENT_PROMPT
3. **Tests + Integration in parallel** ‚Äî Both done together
4. **plugin-otaku approach** ‚Äî High-level wrapper actions with confirmation flows, not just pass-through
